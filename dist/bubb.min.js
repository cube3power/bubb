"use strict";!function(){var a=this,b=function(a,c){b.initialized?console.log("bubb already initialized. use bubb.add to process new DOM elements or bubb.update to modiy existing instances"):b.initialize(a,c),b.initialized=!0};b.initialize=function(a,c){b.config=b.config||("object"==typeof a?a:{}),b.config._=b.config._||a._||{},b.callback=b.callback||"function"==typeof c&&c;var d=Array.from(document.querySelectorAll("[data-bubb]:not(.bubb)"));d.length&&d.forEach(b.buildElement)},b.buildElement=function(c){function d(a){return(i||Object.keys(b.config._).length)&&b.availableOptions.forEach(function(c){a[c]=i[c]||b.config._[c]}),a}function e(a,c,d){if("_"!==d){var e=d?b.config[a][d]:b.config[a]||a,f=a+(d&&"text"!==d?"."+d:""),g=' data-bubb-value="'+f+'"';return c+="<div "+g+(">"+e)+"</div>"}}var f=c.dataset.bubb.trim(),g=b.config[f],h="object"==typeof g,i=!(!h||!g.hasOwnProperty("_"))&&g._,j=h&&!g.hasOwnProperty("text"),k="function"==typeof b.callback||"function"==typeof b.config._.callback;c.bubb={config:d({}),type:j?"menu":i?"opts":"string",bind:j&&k||i&&"function"==typeof i.callback};var l=j?Object.keys(g):i?["text"]:[!1],m=l.reduce(e.bind(a,f),"");b.configureElement(c,null,m)},b.configureElement=function(a,c,d){c=c||document.createElement("aside");var e=a.bubb.config,f=!d;e.background&&(c.style.background=e.background,c.style.borderBottomColor=e.background),e.color&&(c.style.color=e.color),a.classList.add("bubb"),e.transitionOff?a.classList.add("bubb-still"):f&&a.classList.remove("bubb-still"),e.delay?a.classList.add("bubb-delayed"):f&&a.classList.remove("bubb-delayed"),("menu"===a.bubb.type||e.callback)&&a.classList.add("bubb-interactive"),e.interactive?a.classList.add("bubb-interactive"):f&&e.hasOwnProperty("interactive")&&a.classList.remove("bubb-interactive"),"menu"===a.bubb.type&&a.classList.add("bubb-menu"),f||(c.innerHTML=d,a.appendChild(c)),a.bubb.bind&&b.bindElement(a)},b.bindElement=function(a){function c(c){var d=a.bubb.config.hoverCallback,e=d?this.dataset.bubb:c.target.dataset.bubbValue||c.target.parentNode.dataset.bubbValue;if(e){var f="function"==typeof this.bubb.config.callback&&this.bubb.config.callback||b.callback,g=this.querySelector('[data-bubb-value="'+this.dataset.bubb+'"]')||c.target;f(e,g)}}a.bubb.bind=!0,a.addEventListener(a.bubb.config.hoverCallback?"mouseenter":"click",c,!1)},b.update=function(a,c){if("string"==typeof a&&c){var d,e="object"==typeof c,f=document.querySelector('[data-bubb-value="'+a+'"]');if(!f&&e&&(d=document.querySelector('[data-bubb="'+a+'"]')),f||d){e||(f.innerHTML=c);var g=d||f.parentNode.parentNode;if(e){var h="boolean"==typeof c.callback&&!g.bubb.bind,i=c.callback&&!g.bubb.config.hasOwnProperty("callback"),j=c.hoverCallback&&!g.bubb.config.hoverCallback;Object.keys(c).forEach(function(a){~b.availableOptions.indexOf(a)&&(g.bubb.config[a]=c[a])});var k=d?d.children[0]:f.parentNode;b.configureElement(g,k),(h||i||j)&&b.bindElement(g)}b.updateConfig(a,c,e,g)}}},b.add=function(){b.addOrRemove.apply(a,arguments)},b.remove=function(){b.addOrRemove.apply(a,arguments)},b.addOrRemove=function(){if(0===arguments.length)return void b.initialize();var a=arguments[0],c=arguments[1],d=a.split(".");if(d.length>1&&b.config[d[0]]){var e=d[0],f=d[1];if(c&&"string"==typeof c&&!b.config[e][f])return b.config[e][f]=c,void document.querySelector('[data-bubb="'+e+'"]').children[0].insertAdjacentHTML("beforeend",'<div data-bubb-value="'+a+('">'+c)+"</div>");if(!c&&b.config[e][f]){delete b.config[e][f];var g=document.querySelector('[data-bubb="'+e+'"]').children[0];Array.from(g.children).forEach(function(b){b.dataset.bubbValue===a&&g.removeChild(b)})}}},b.updateConfig=function(a,c,d,e){var f=!!~a.indexOf(".")&&a.split("."),g="opts"===e.bubb.type;if(f||g||d){var h=f?f[0]:a;d?d&&(f?b.config[h]._=c:g||(b.config[h]={text:b.config[h],_:c},"opts"===e.bubb.type),Object.assign(b.config[h]._,c)):b.config[h][f?f[1]:"text"]=c}else b.config[a]=c},b.availableOptions=["callback","hoverCallback","background","color","transitionOff","interactive","delay"],"undefined"!=typeof exports&&null!==exports?exports.bubb=b:window.bubb=b}(this);