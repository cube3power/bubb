/* bubb v2.0.0 (2017-08-17) | http://bubb.surge.sh | (c) 2017 frdnrdb | licensed MIT */
!function(a,b){var c=this,d=function(a,c){d.config=d.config||("object"==typeof a?a:{}),d.config._=d.config._||a._||{},d.callback=d.callback||"function"==typeof d.config._.callback&&d.config._.callback||"function"==typeof c&&c;var f="update"===arguments[0]?[arguments[1]]:Array.from(b.querySelectorAll("[data-bubb]:not(.bubb)"));f.length&&(!d.initialized&&B(),f.forEach(e))},e=function(b){var e=b.dataset.bubb.trim(),i=d.config[e],j="object"==typeof i,k=j&&i._,l=j&&!i.hasOwnProperty("text"),m=l?Object.keys(i):k?["text"]:[!1],n="function"==typeof d.callback||"function"==typeof d.config._.callback,o=a.getComputedStyle(b).position;b._bubb={key:e,config:f(k),type:l?"menu":k?"opts":"string",markup:m.reduce(g.bind(c,e),""),bind:l&&n||k&&("function"==typeof k.callback||"boolean"==typeof k.callback)},o&&!o.match(/absolute|fixed|relative/)&&(b.style.position="relative"),b.classList.add("bubb"),h(b)},f=function(a){return C.reduce(function(b,c){return a&&a.hasOwnProperty(c)?b[c]=a[c]:!!d.config._.hasOwnProperty(c)&&(b[c]=d.config._[c]),b},{})},g=function(a,b,c){if("_"===c)return"";var e=c?d.config[a][c]:d.config[a]||a,f=a+(c&&"text"!==c?"."+c:""),g=' data-bubb-value="'+f+'"';return b+="<div "+g+(">"+e)+"</div>"},h=function(a){var b=D?["touchstart","touchend"]:["mouseenter","mouseleave"];!D&&a._bubb.bind&&b.push("mousedown"),b.forEach(function(b){return a.addEventListener(b,j,!1)})},i=function(a){var b=a._bubb,c=d._element,e=c._config=b.config;c._elementContent.innerHTML=b.markup,c._bind=b.bind&&e.interactive!==!1,c.className=e["class"]||"",m(e,a,c),"menu"===b.type&&a.classList.add("bubb-menu"),d.previousKey=b.key,x(d._element,"_bubblePreactive"),a.appendChild(c)},j=function(b){if(this._bubb&&(a.clearTimeout(d._timeout),d.previousKey!==this._bubb.key&&i(this),"mouseenter"===b.type||"touchstart"===b.type?d._timeout=a.setTimeout(function(){return x(d._element,"_bubbleActive")},0|this._bubb.config.delay||0):"mousedown"!==b.type&&x(d._element,["_bubbleInactive","_bubblePreactive"]),this._bubb.bind&&"mouseleave"!==b.type)){var c=this._bubb.config.hoverCallback,e=c?this.dataset.bubb:b.target.dataset.bubbValue||b.target.parentNode.dataset.bubbValue;if(e){var f="function"==typeof this._bubb.config.callback&&this._bubb.config.callback||d.callback,g=this.querySelector('[data-bubb-value="'+this.dataset.bubb+'"]')||b.target;f(e,g)}}},k=function(){var a=arguments[0],c=arguments[1];if("string"==typeof a&&c){var e="object"==typeof c,f=a.split(".").reduce(function(a,b,c){return a[["key","val"][c]]=b,a},{}),g=b.querySelector('[data-bubb="'+(f.key||a)+'"]');if(g||e){if(!g)return void console.error("bubb: trying to update a non-existing element");if(g._bubb||d("update",g),d.previousKey=!1,!e)return void(g._bubb.markup=g._bubb.markup.replace(new RegExp('<div\\s+data-bubb-value="'+a+'">.*?</div>'),'<div data-bubb-value="'+a+('">'+c)+"</div>"));var h="boolean"==typeof c.callback&&!g._bubb.bind,i="function"==typeof c.callback&&!g._bubb.config.hasOwnProperty("callback"),k=c.hoverCallback&&!g._bubb.config.hoverCallback;(h||i||k)&&(g._bubb.bind=!0),(h||i)&&g.addEventListener("mousedown",j,!1),Object.keys(c).forEach(function(a){~C.indexOf(a)&&(g?g._bubb.config[a]=c[a]:d.config._[a]=c[a])}),n(a,c,e,g)}}},l=function(){if(0===arguments.length)return void d();var a=arguments[0],c=arguments[1],e=a.split(".").reduce(function(a,b,c){return a[["key","val"][c]]=b,a},{});if(e.val&&d.config[e.key]){if(d.previousKey=!1,c&&"string"==typeof c&&!d.config[e.key][e.val])return d.config[e.key][e.val]=c,void(b.querySelector('[data-bubb="'+e.key+'"]')._bubb.markup+='<div data-bubb-value="'+a+('">'+c)+"</div>");if(!c&&d.config[e.key][e.val]){delete d.config[e.key][e.val];var f=b.querySelector('[data-bubb="'+e.key+'"]');f._bubb.markup=f._bubb.markup.replace(new RegExp('<div\\s+data-bubb-value="'+a+'">.*?</div>'),"")}}},m=function(a,c,d){var e=a.width,f=a.anchor,g=a.direction,h="east"===g||"west"===g;if("string"==typeof e&&parseInt(e))return void(d.style.width=e);var i=0|e||b.querySelector(e);if(!i)return void(d.style.width="100%");var j=30,k="object"==typeof i,l=b.body.offsetWidth,m=c.getBoundingClientRect(),n=m.width/2,o=m.left,p=m.right,q=k?i.offsetWidth:100===i?l-2*j:i*l/100;if(f||h){var r=!h&&f?"left"===f?l-o-j:"right"===f&&l-(l-p)-j:"east"===g?l-p-j:"west"===g&&o-j;if(r)return void(d.style.width=Math.min(q,r)+"px")}var s=Math.min(q,2*((o+n>l/2?l-p+n:o+n)-j));d.style.width=s+"px",d.style.left=n-s/2+"px",d._elementTip.style.left=s/2+"px"},n=function(a,b,c,e){var f="menu"===e._bubb.type,g="opts"===e._bubb.type,h=~a.indexOf(".")&&a.split("."),i=h?h.reduce(function(a,b,c){return a[["key","val"][c]]=b,a},{}):{};if(!f&&!g&&!c)return void(d.config[a]=b);var j=i.key||a;return c?f||g?(d.config[j]._=d.config[j]._||b,void Object.assign(d.config[j]._,b)):(d.config[j]={text:d.config[j],_:b},void("opts"===e._bubb.type)):void(d.config[j][i.val||"text"]=b)},o={tipsize:"12px",offset:".15em",distance:"20px",easing:"cubic-bezier(0,0,0,1)",duration:".3s",background:"#444",color:"#fff",rounding:"4px",fontsize:"17px"},p={_bubble:{position:"absolute",zIndex:"99",display:"block",padding:".75em .9em .85em",lineHeight:"1.1",textAlign:"center",cursor:"default",minWidth:"150px",width:"100%",boxSizing:"border-box",textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",wordWrap:"break-word",hyphens:"auto",WebkitTouchCallout:"none",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none",userSelect:"none"},_bubbleInactive:{visibility:"hidden",pointerEvents:"none",opacity:"0"},_bubblePreactive:{background:o.background,borderBottomColor:o.background,color:o.color,fontSize:o.fontsize},_bubbleActive:{transitionProperty:"opacity, transform",transitionDuration:o.duration,transitionTimingFunction:o.easing,pointerEvents:"all",opacity:"1",visibility:"visible"},_bubbleInteractive:{position:"absolute",zIndex:"-1",display:"none",width:"calc( 100% + ( "+o.tipsize+(" + "+o.offset)+" ) * 2 )",height:"calc( 100% + ( "+o.tipsize+(" + "+o.offset)+" ) * 2 )",top:"calc( -1 * ( "+o.tipsize+(" + "+o.offset)+" ) )",left:"calc( -1 * ( "+o.tipsize+(" + "+o.offset)+" ) )",pointerEvents:"all",background:"transparent"},_bubbleTip:{position:"absolute",width:"0",height:"0",borderLeft:""+o.tipsize+" solid transparent",borderRight:""+o.tipsize+" solid transparent",borderBottomWidth:o.tipsize,borderBottomStyle:"solid",borderBottomColor:"inherit"}},q={positive:{active:"calc( 100% + "+o.tipsize+(" + "+o.offset)+" )",inactive:"calc( 100% + "+o.tipsize+(" + "+o.offset)+(" + "+o.distance)+" )"},negative:{active:"calc( -100% - "+o.tipsize+(" - "+o.offset)+" )",inactive:"calc( -100% - "+o.tipsize+(" - "+o.offset)+(" - "+o.distance)+" )"}},r={x:{east:q.positive,west:q.negative},y:{south:q.positive,north:q.negative}},s={south:{left:[0,1,1,1],right:[1,0,1,1]},north:{left:[1,1,0,1],right:[1,1,1,0]},east:{left:[0,1,1,1],right:[1,1,1,0]},west:{left:[1,0,1,1],right:[1,1,0,1]}},t=function(a,b){return b?"left"===b&&a||"right"===b&&!a?0:"auto":a?"50%":"auto"},u={south:{left:t.bind(this,!0),right:t.bind(this,!1),top:function(a,b){return b?"calc( 2px - "+o.tipsize+" )":"auto"},bottom:function(a,b){return b?"auto":0}},north:{left:function(a,b){return t(!0,b&&a?"left"===a?"right":"left":a)},right:function(a,b){return t(!1,b&&a?"left"===a?"right":"left":a)},top:function(a,b){return b?"auto":0},bottom:function(a,b){return b?"calc( 2px - "+o.tipsize+" )":"auto"}},east:{left:function(a,b){return b?"calc( 2px - "+o.tipsize+" )":"auto"},right:function(a,b){return b?"auto":0},top:function(a,b){return b?t(!0,a):a&&"left"!==a?"auto":"50%"},bottom:function(a,b){return b?t(!1,a):"right"===a?"50%":"auto"}},west:{left:function(a,b){return b?"auto":0},right:function(a,b){return b?"calc( 2px - "+o.tipsize+" )":"auto"},top:function(a,b){return b?t(!0,a):a&&"left"!==a?"auto":"50%"},bottom:function(a,b){return b?t(!1,a):"right"===a?"50%":"auto"}}},v={south:{center:"translate(-50%, 0)",left:"translate(-25%, 50%) rotate(90deg)",right:"translate(25%, 50%) rotate(-90deg)"},north:{center:"translate(-50%, 0) rotate(180deg)",left:"translate(25%, -50%) rotate(-90deg)",right:"translate(-25%, -50%) rotate(90deg)"},east:{center:"translate(-25%, -50%) rotate(-90deg)",left:"translate(0, 0) rotate(180deg)",right:"translate(0, 0)"},west:{center:"translate(25%, -50%) rotate(90deg)",left:"translate(0, 0) rotate(180deg)",right:"translate(0, 0)"}},w=function(a,b,c){var d=b.direction||"south",e=b.anchor,f=function(a){return"object"==typeof r[a][d]&&r[a][d][c]||(e?"0":"-50%")};a.style.transform="translate("+f("x")+(", "+f("y"))+")","active"!==c&&(a._elementInteractive.style.display=a._bind?"block":"none",a._elementTip.style.transform=v[d][e||"center"],["left","right","top","bottom"].forEach(function(b){a.style[b]=u[d][b](e),a._elementTip.style[b]=u[d][b](e,!0)}),a.style.borderRadius=(s[d][e]||[1]).reduce(function(a,c){return a+=(c?b.borderRadius||o.rounding:0)+" "},""))},x=function(a,b,c){function d(a){if(a){if(Array.isArray(a))return 0;var b;if(i&&i(a),"object"==typeof a&&"function"==typeof(b=a[h]))return i&&i(void 0),b.call(a);if(i&&i(void 0),a+""=="[object Generator]")return a}throw new Error(a+" is not iterable")}var e,f,g,h="undefined"!=typeof Symbol&&Symbol&&Symbol.iterator||"@@iterator",i="undefined"!=typeof Symbol&&Symbol&&Symbol.__setObjectSetter__,j=a._config||{};b="string"==typeof b?[b]:b,e=d(b),g=0===e,f=g?b.length:void 0;for(var k;g?e<f:!(f=e.next()).done;){k=g?b[e++]:f.value;var l="_bubbleActive"===k,m="_bubblePreactive"===k,n=l&&j.transitionOff,o=m&&j.background,q=m&&j.color,r=m&&j.fontSize;for(var s in p[k])a.style[s]=c?p[k][s]:"transitionDuration"===s&&n?"0s":"background"!==s&&"borderBottomColor"!==s||!o?"color"===s&&q?q:"fontSize"===s&&r?r:p[k][s]:o;c||!l&&!m||w(a,j,l?"active":"inactive")}e=f=g=void 0},y=function(){d.update=function(){return k.apply(c,arguments)},d.add=d.refresh=d.remove=function(){return l.apply(c,arguments)}},z=function(){d._element=b.createElement("bubb-bobb");var a=d._element,c={_elementInteractive:"bubb-interactive",_elementTip:"bubb-tip",_elementContent:"bubb-content"};for(var e in c)a[e]=b.createElement(c[e]),a.appendChild(a[e]);x(a,["_bubble","_bubbleInactive"],!0),x(a._elementTip,"_bubbleTip",!0),x(a._elementInteractive,"_bubbleInteractive",!0),d._dimmer=b.createElement("bubb-dimmer"),d._dimmer.style.display="none",d._dimmer.appendChild(a),b.body.appendChild(d._dimmer)},A=function(){var a=function(){return d._element._bind||x(d._element,"_bubbleInactive",!0)};d._element.addEventListener(D?"touchstart":"mouseenter",a,!1)},B=function(){d.initialized=!0,y(),z(),A()},C=["callback","hoverCallback","background","color","transitionOff","interactive","delay","width","fontSize","class","anchor","direction","borderRadius"],D=!("undefined"==typeof a.orientation&&!~a.navigator.userAgent.indexOf("IEMobile"));"undefined"!=typeof module&&module.exports?module.exports=d:a.bubb=d}(window,document);